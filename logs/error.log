{"asctime": "2025-08-30 04:46:03,138", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T04:46:03.143485Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 04:51:03,735", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T04:51:03.736078Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 04:56:02,390", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T04:56:02.391181Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:01:02,267", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:01:02.268236Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:06:03,446", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:06:03.446591Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:11:03,565", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:11:03.565855Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:16:04,080", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:16:04.081217Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:21:02,127", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:21:02.129806Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:26:02,080", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:26:02.080940Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:31:02,269", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:31:02.270188Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:36:03,560", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:36:03.560928Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:41:02,068", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:41:02.068583Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:46:02,327", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:46:02.328234Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:51:03,939", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:51:03.940217Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 05:56:02,108", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T05:56:02.109267Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:01:02,151", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:01:02.152454Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:06:02,332", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:06:02.332617Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:11:02,407", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:11:02.407801Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:16:02,035", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:16:02.035599Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:21:02,176", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:21:02.176904Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:26:02,186", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:26:02.187353Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:31:02,586", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:31:02.586725Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:36:02,238", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:36:02.239380Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:41:03,710", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:41:03.711849Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:46:02,256", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:46:02.257228Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:51:02,176", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:51:02.177768Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 06:56:04,122", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T06:56:04.123155Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:01:02,319", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:01:02.320064Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:06:03,583", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:06:03.583834Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:11:02,553", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:11:02.553863Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:16:09,809", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T07:16:09.810321Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:16:09,810", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T07:16:09.811107Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:20:59,616", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T07:20:59.617412Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:20:59,617", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T07:20:59.618160Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:25:59,711", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T07:25:59.711756Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:25:59,711", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T07:25:59.712774Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:31:03,588", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T07:31:03.589466Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:31:03,589", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T07:31:03.590698Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:36:03,622", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:36:03.622809Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:41:02,696", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:41:02.696991Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:46:02,463", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:46:02.463994Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:51:02,373", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:51:02.374159Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 07:56:03,638", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T07:56:03.639227Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:01:03,612", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:01:03.613349Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:06:02,534", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:06:02.534981Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:11:02,464", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:11:02.465410Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:16:02,398", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:16:02.398559Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:21:02,336", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:21:02.337247Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:26:03,781", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:26:03.783818Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:31:02,486", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:31:02.487265Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:36:05,266", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:36:05.267272Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:41:06,629", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:41:06.630355Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:46:02,249", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:46:02.250526Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:51:02,208", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:51:02.210640Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 08:56:02,737", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T08:56:02.740619Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:01:02,344", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:01:02.345176Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:06:02,501", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:06:02.502129Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:11:06,127", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:11:06.127922Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:16:09,796", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T09:16:09.799162Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:16:09,799", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T09:16:09.800443Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:21:09,805", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T09:21:09.806244Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:21:09,806", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T09:21:09.807151Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:26:02,742", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:26:02.743044Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:31:02,460", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:31:02.461532Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:36:03,146", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:36:03.146915Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:41:02,590", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:41:02.591339Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:46:02,693", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:46:02.694184Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 09:54:56,199", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T09:54:56.199812Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 10:41:46,010", "levelname": "ERROR", "name": "app.middlewares.logging_middleware", "funcName": "dispatch", "lineno": 141, "message": "Request failed: POST /api/requests/", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 144, in simple_response\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 61, in create_blood_request\n    \"quantity\": request_data.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 984, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\nAttributeError: 'BloodRequestCreate' object has no attribute 'quantity'", "extra_fields": {"http_method": "POST", "path": "/api/requests/", "error_type": "AttributeError", "error_message": "'BloodRequestCreate' object has no attribute 'quantity'", "response_time_seconds": 0.3369, "client_ip": "127.0.0.1", "action": "request_failed"}, "timestamp": "2025-08-30T10:41:46.393991Z", "environment": "development", "request_id": "8df311fd-d27b-40b4-8e4a-950967ecc9f6", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "'BloodRequestCreate' object has no attribute 'quantity'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 144, in simple_response\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 61, in create_blood_request\n    \"quantity\": request_data.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 984, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\n", "AttributeError: 'BloodRequestCreate' object has no attribute 'quantity'\n"]}, "http_method": "POST", "path": "/api/requests/", "error_type": "AttributeError", "error_message": "'BloodRequestCreate' object has no attribute 'quantity'", "response_time_seconds": 0.3369, "client_ip": "127.0.0.1", "action": "request_failed"}
{"asctime": "2025-08-30 10:44:44,171", "levelname": "ERROR", "name": "app.services.request", "funcName": "wrapper", "lineno": 43, "message": "create_bulk_request failed after 0.012 seconds: 400: Cannot send requests to your own facility. Please select other facilities.", "timestamp": "2025-08-30T10:44:44.172401Z", "environment": "development", "request_id": "b526acf9-d41b-4435-96ea-4187a185e6b9", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api"}
{"asctime": "2025-08-30 10:59:15,629", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T10:59:15.630377Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 10:59:22,296", "levelname": "ERROR", "name": "app.routes.request", "funcName": "create_blood_request", "lineno": 122, "message": "Blood request creation failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 79, in create_blood_request\n    resource_id=str(result.group_id),\n                    ^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 984, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\nAttributeError: 'BloodRequestBulkCreateResponse' object has no attribute 'group_id'", "event_type": "blood_request_creation_error", "current_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_type": "B+", "error": "'BloodRequestBulkCreateResponse' object has no attribute 'group_id'", "duration_ms": 241.68658256530762, "timestamp": "2025-08-30T10:59:22.307063Z", "environment": "development", "request_id": "597504ee-e791-41dc-a683-b7e65b7c6101", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "'BloodRequestBulkCreateResponse' object has no attribute 'group_id'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 79, in create_blood_request\n    resource_id=str(result.group_id),\n                    ^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 984, in __getattr__\n    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')\n", "AttributeError: 'BloodRequestBulkCreateResponse' object has no attribute 'group_id'\n"]}}
{"asctime": "2025-08-30 11:11:13,051", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:11:13.052583Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:16:06,235", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:16:06.236575Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:21:06,048", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:21:06.049276Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:26:06,164", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:26:06.165462Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:31:07,799", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:31:07.800001Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:36:08,879", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:36:08.879789Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:41:05,987", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:41:05.988432Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:46:06,096", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:46:06.097552Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:51:06,202", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:51:06.203287Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 11:56:07,223", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T11:56:07.224917Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:01:08,446", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:01:08.447246Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:06:06,289", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:06:06.296077Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:11:06,171", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:11:06.172575Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:16:07,001", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:16:07.002195Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:21:08,738", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:21:08.739367Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:26:06,486", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:26:06.486958Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:31:07,655", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:31:07.656391Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:36:08,608", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:36:08.609215Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:41:13,571", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T12:41:13.572003Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:41:13,572", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T12:41:13.573038Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:46:13,581", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T12:46:13.583276Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:46:13,583", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T12:46:13.585934Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:51:06,187", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:51:06.188442Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 12:56:07,399", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T12:56:07.400015Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 13:01:06,593", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T13:01:06.594387Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 14:46:13,531", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T14:46:13.531920Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 14:46:13,532", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T14:46:13.533013Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 14:51:13,451", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T14:51:13.452236Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 14:51:13,452", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T14:51:13.453041Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 14:56:13,604", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T14:56:13.605689Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 14:56:13,605", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T14:56:13.606607Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:01:13,468", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T15:01:13.469572Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:01:13,469", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T15:01:13.470623Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:06:13,577", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T15:06:13.578178Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:06:13,578", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T15:06:13.579168Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:16:18,049", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T15:16:18.050589Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:16:20,962", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T15:16:20.963355Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:20:44,163", "levelname": "ERROR", "name": "app.routes.request", "funcName": "respond_to_request", "lineno": 1208, "message": "Request response failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 1167, in respond_to_request\n    \"quantity\": updated_request.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'BloodRequest' object has no attribute 'quantity'", "event_type": "request_response_error", "current_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "request_id": "a856c87b-e0e1-4365-a46e-6658ab68721a", "error": "'BloodRequest' object has no attribute 'quantity'", "duration_ms": 361.8168830871582, "timestamp": "2025-08-30T15:20:44.403295Z", "environment": "development", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "'BloodRequest' object has no attribute 'quantity'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 1167, in respond_to_request\n    \"quantity\": updated_request.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'BloodRequest' object has no attribute 'quantity'\n"]}}
{"asctime": "2025-08-30 15:21:13,453", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T15:21:13.454707Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:21:13,455", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T15:21:13.455676Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 15:22:06,586", "levelname": "ERROR", "name": "app.routes.request", "funcName": "respond_to_request", "lineno": 1208, "message": "Request response failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 1167, in respond_to_request\n    \"quantity\": updated_request.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'BloodRequest' object has no attribute 'quantity'", "event_type": "request_response_error", "current_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "request_id": "efa13e1c-63d3-490d-ade9-4c5440028413", "error": "'BloodRequest' object has no attribute 'quantity'", "duration_ms": 82.75818824768066, "timestamp": "2025-08-30T15:22:06.592046Z", "environment": "development", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "'BloodRequest' object has no attribute 'quantity'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 1167, in respond_to_request\n    \"quantity\": updated_request.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'BloodRequest' object has no attribute 'quantity'\n"]}}
{"asctime": "2025-08-30 18:11:07,370", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T18:11:07.371556Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 18:16:06,042", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T18:16:06.042938Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 18:19:14,139", "levelname": "ERROR", "name": "app.routes.request", "funcName": "respond_to_request", "lineno": 1208, "message": "Request response failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 1167, in respond_to_request\n    \"quantity\": updated_request.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'BloodRequest' object has no attribute 'quantity'", "event_type": "request_response_error", "current_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "request_id": "0426b5e4-f255-4134-8b41-db8299d2ca18", "error": "'BloodRequest' object has no attribute 'quantity'", "duration_ms": 51.54156684875488, "timestamp": "2025-08-30T18:19:14.143788Z", "environment": "development", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "'BloodRequest' object has no attribute 'quantity'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 1167, in respond_to_request\n    \"quantity\": updated_request.quantity,\n                ^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: 'BloodRequest' object has no attribute 'quantity'\n"]}}
{"asctime": "2025-08-30 18:26:07,773", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T18:26:07.774151Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 18:31:08,541", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T18:31:08.542615Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:36:05,242", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T20:36:05.243409Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:36:05,244", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T20:36:05.245405Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:41:17,020", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T20:41:17.021345Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:46:14,375", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T20:46:14.377116Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:46:14,377", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T20:46:14.378299Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:51:14,559", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T20:51:14.560473Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:51:14,560", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T20:51:14.561403Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:56:14,434", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T20:56:14.436296Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 20:56:14,436", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T20:56:14.437933Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:01:06,918", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T21:01:06.919185Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:26:14,348", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T21:26:14.349302Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:26:14,349", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T21:26:14.350047Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:31:15,000", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T21:31:15.001277Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:31:15,001", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T21:31:15.002013Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:36:17,886", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T21:36:17.888040Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:36:17,888", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T21:36:17.888759Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:41:07,073", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T21:41:07.074079Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:49:42,551", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T21:49:42.551828Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 21:56:43,075", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T21:56:43.076189Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 22:03:26,503", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "create_distribution", "lineno": 232, "message": "Distribution creation failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\nsqlite3.IntegrityError: NOT NULL constraint failed: track_states.blood_request_id\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 145, in create_distribution\n    new_distribution = await distribution_service.create_distribution(\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\distribution.py\", line 101, in create_distribution\n    await self.db.commit()\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 1015, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('52baaa58ff9946798d845d3184953305', <TrackStateStatus.pending_receive: 'pending receive'>, 'Korle-Bu Blood Bank', 'Distribution created, awaiting dispatch', '2025-08-30 22:03:26.474928', '96a95bae70104a10bfb83a829608f172', None, '88e3fafa3fdc408ea261f5dfdd43b2bb')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "event_type": "distribution_creation_error", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "dispatched_to_id": "unknown", "error": "(sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('52baaa58ff9946798d845d3184953305', <TrackStateStatus.pending_receive: 'pending receive'>, 'Korle-Bu Blood Bank', 'Distribution created, awaiting dispatch', '2025-08-30 22:03:26.474928', '96a95bae70104a10bfb83a829608f172', None, '88e3fafa3fdc408ea261f5dfdd43b2bb')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "duration_ms": 111.04083061218262, "timestamp": "2025-08-30T22:03:27.401580Z", "environment": "development", "request_id": "90716715-3d48-4d4e-83cb-72909d4db926", "service": "blood-bank-api", "exception": {"type": "IntegrityError", "message": "(sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('52baaa58ff9946798d845d3184953305', <TrackStateStatus.pending_receive: 'pending receive'>, 'Korle-Bu Blood Bank', 'Distribution created, awaiting dispatch', '2025-08-30 22:03:26.474928', '96a95bae70104a10bfb83a829608f172', None, '88e3fafa3fdc408ea261f5dfdd43b2bb')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\n", "sqlite3.IntegrityError: NOT NULL constraint failed: track_states.blood_request_id\n", "\nThe above exception was the direct cause of the following exception:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 145, in create_distribution\n    new_distribution = await distribution_service.create_distribution(\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\distribution.py\", line 101, in create_distribution\n    await self.db.commit()\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 1015, in commit\n    await greenlet_spawn(self.sync_session.commit)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n", "  File \"<string>\", line 2, in commit\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n", "  File \"<string>\", line 2, in _prepare_impl\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\n", "sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('52baaa58ff9946798d845d3184953305', <TrackStateStatus.pending_receive: 'pending receive'>, 'Korle-Bu Blood Bank', 'Distribution created, awaiting dispatch', '2025-08-30 22:03:26.474928', '96a95bae70104a10bfb83a829608f172', None, '88e3fafa3fdc408ea261f5dfdd43b2bb')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\n"]}}
{"asctime": "2025-08-30 22:07:08,194", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T22:07:08.194818Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 22:11:24,250", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "create_distribution", "lineno": 232, "message": "Distribution creation failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 216, in create_distribution\n    **BloodDistributionResponse.model_validate(new_distribution, from_attributes=True).model_dump(),\n      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 693, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "event_type": "distribution_creation_error", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "dispatched_to_id": "unknown", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 173.2165813446045, "timestamp": "2025-08-30T22:11:24.483750Z", "environment": "development", "request_id": "4a389a5c-6663-4a6c-98c6-6d6541c8e556", "service": "blood-bank-api", "exception": {"type": "ValidationError", "message": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 216, in create_distribution\n    **BloodDistributionResponse.model_validate(new_distribution, from_attributes=True).model_dump(),\n      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 693, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum\n"]}}
{"asctime": "2025-08-30 22:15:10,098", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "create_distribution", "lineno": 232, "message": "Distribution creation failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 216, in create_distribution\n    **BloodDistributionResponse.model_validate(new_distribution, from_attributes=True).model_dump(),\n      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 693, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "event_type": "distribution_creation_error", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "dispatched_to_id": "unknown", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 123.50106239318848, "timestamp": "2025-08-30T22:15:10.110706Z", "environment": "development", "request_id": "12298cd5-f0fd-4f4f-a347-36d3fcd717f5", "service": "blood-bank-api", "exception": {"type": "ValidationError", "message": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 216, in create_distribution\n    **BloodDistributionResponse.model_validate(new_distribution, from_attributes=True).model_dump(),\n      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 693, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum\n"]}}
{"asctime": "2025-08-30 22:18:01,532", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T22:18:01.533230Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 22:24:18,604", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T22:24:18.605427Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 22:29:17,312", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T22:29:17.313030Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 22:30:15,917", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "create_distribution", "lineno": 232, "message": "Distribution creation failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 216, in create_distribution\n    **BloodDistributionResponse.model_validate(new_distribution, from_attributes=True).model_dump(),\n      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 693, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\npydantic_core._pydantic_core.ValidationError: 1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending receive', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "event_type": "distribution_creation_error", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "dispatched_to_id": "unknown", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending receive', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 135.41460037231445, "timestamp": "2025-08-30T22:30:15.927898Z", "environment": "development", "request_id": "a7441dde-2128-4949-9b78-494074df36d6", "service": "blood-bank-api", "exception": {"type": "ValidationError", "message": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending receive', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 216, in create_distribution\n    **BloodDistributionResponse.model_validate(new_distribution, from_attributes=True).model_dump(),\n      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 693, in model_validate\n    return cls.__pydantic_validator__.validate_python(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending receive', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum\n"]}}
{"asctime": "2025-08-30 22:35:58,502", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "list_distributions", "lineno": 615, "message": "Distribution list retrieval failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 556, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\nKeyError: <DistributionStatus.pending: 'pending'>", "event_type": "distribution_list_error", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "error": "<DistributionStatus.pending: 'pending'>", "duration_ms": 42.21606254577637, "timestamp": "2025-08-30T22:35:58.510343Z", "environment": "development", "request_id": "18a6f6bc-eba8-490e-9986-a6beb2812dd2", "service": "blood-bank-api", "exception": {"type": "KeyError", "message": "<DistributionStatus.pending: 'pending'>", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 556, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\n", "KeyError: <DistributionStatus.pending: 'pending'>\n"]}}
{"asctime": "2025-08-30 22:38:22,646", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T22:38:22.647602Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 22:39:34,279", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "list_distributions", "lineno": 615, "message": "Distribution list retrieval failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 556, in list_distributions\n    enum_status = BloodDistributionStatus[status.name]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\nKeyError: 'pending'", "event_type": "distribution_list_error", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "error": "'pending'", "duration_ms": 32.10568428039551, "timestamp": "2025-08-30T22:39:34.287900Z", "environment": "development", "request_id": "23c43315-8f84-4eb6-b5bd-cab3b2cdf3fa", "service": "blood-bank-api", "exception": {"type": "KeyError", "message": "'pending'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 556, in list_distributions\n    enum_status = BloodDistributionStatus[status.name]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\n", "KeyError: 'pending'\n"]}}
{"asctime": "2025-08-30 22:53:27,411", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T22:53:27.412027Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 22:56:23,428", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "list_distributions", "lineno": 678, "message": "Distribution list retrieval failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 603, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\nKeyError: <DistributionStatus.pending: 'pending receive'>", "event_type": "distribution_list_error", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "error": "<DistributionStatus.pending: 'pending receive'>", "duration_ms": 25.15387535095215, "timestamp": "2025-08-30T22:56:23.435757Z", "environment": "development", "request_id": "1d2dc3da-718c-4b5c-a31f-f36fa0e70e45", "service": "blood-bank-api", "exception": {"type": "KeyError", "message": "<DistributionStatus.pending: 'pending receive'>", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 603, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\n", "KeyError: <DistributionStatus.pending: 'pending receive'>\n"]}}
{"asctime": "2025-08-30 22:58:11,272", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "list_distributions", "lineno": 678, "message": "Distribution list retrieval failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 603, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\nKeyError: <DistributionStatus.pending_pending: 'pending receive'>", "event_type": "distribution_list_error", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "error": "<DistributionStatus.pending_pending: 'pending receive'>", "duration_ms": 27.664899826049805, "timestamp": "2025-08-30T22:58:11.279330Z", "environment": "development", "request_id": "704ffc91-50be-4255-9aa7-f0ed24edf56a", "service": "blood-bank-api", "exception": {"type": "KeyError", "message": "<DistributionStatus.pending_pending: 'pending receive'>", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 603, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\n", "KeyError: <DistributionStatus.pending_pending: 'pending receive'>\n"]}}
{"asctime": "2025-08-30 23:01:39,193", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "list_distributions", "lineno": 678, "message": "Distribution list retrieval failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 603, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\nKeyError: <DistributionStatus.pending_receive: 'pending receive'>", "event_type": "distribution_list_error", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "error": "<DistributionStatus.pending_receive: 'pending receive'>", "duration_ms": 30.492544174194336, "timestamp": "2025-08-30T23:01:39.199899Z", "environment": "development", "request_id": "67fe6dc6-b4e5-45d1-82ba-e5c205c7ddde", "service": "blood-bank-api", "exception": {"type": "KeyError", "message": "<DistributionStatus.pending_receive: 'pending receive'>", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 603, in list_distributions\n    enum_status = BloodDistributionStatus[status]\n                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\enum.py\", line 793, in __getitem__\n    return cls._member_map_[name]\n           ~~~~~~~~~~~~~~~~^^^^^^\n", "KeyError: <DistributionStatus.pending_receive: 'pending receive'>\n"]}}
{"asctime": "2025-08-30 23:08:20,507", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: ", "timestamp": "2025-08-30T23:08:20.508056Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:08:20,508", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: ", "timestamp": "2025-08-30T23:08:20.509295Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:13:10,279", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19022-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T23:13:10.280023Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:13:10,280", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_coordinates", "lineno": 42, "message": "Failed to fetch GPS for DA-19021-2345: [Errno 11001] getaddrinfo failed", "timestamp": "2025-08-30T23:13:10.280876Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:13:27,949", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "update_distribution", "lineno": 877, "message": "Distribution update failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 788, in update_distribution\n    updated_distribution = await distribution_service.update_distribution(\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        distribution_id, distribution_data\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\distribution.py\", line 144, in update_distribution\n    if new_status == BloodDistributionStatus.delivered and old_status != BloodDistributionStatus.delivered:\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'BloodDistributionStatus' has no attribute 'delivered'", "event_type": "distribution_update_error", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "9c90c82b-7a76-45a1-9555-542c06580135", "error": "type object 'BloodDistributionStatus' has no attribute 'delivered'", "duration_ms": 22.73845672607422, "timestamp": "2025-08-30T23:13:27.989989Z", "environment": "development", "request_id": "e6b66d9b-986c-4492-9ca4-9beb1cc9df63", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "type object 'BloodDistributionStatus' has no attribute 'delivered'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 788, in update_distribution\n    updated_distribution = await distribution_service.update_distribution(\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        distribution_id, distribution_data\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\distribution.py\", line 144, in update_distribution\n    if new_status == BloodDistributionStatus.delivered and old_status != BloodDistributionStatus.delivered:\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: type object 'BloodDistributionStatus' has no attribute 'delivered'\n"]}}
{"asctime": "2025-08-30 23:18:13,638", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T23:18:13.640093Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:24:25,025", "levelname": "ERROR", "name": "app.routes.distribution", "funcName": "update_distribution", "lineno": 877, "message": "Distribution update failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\nsqlite3.IntegrityError: NOT NULL constraint failed: track_states.blood_request_id\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 788, in update_distribution\n    updated_distribution = await distribution_service.update_distribution(\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        distribution_id, distribution_data\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\distribution.py\", line 207, in update_distribution\n    await self.db.commit()\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 1015, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('90a74a9e51e249eab8164a377a4323b3', <TrackStateStatus.received: 'received'>, 'Tamale Teaching Hospital 2', 'Distribution status changed from pending receive to delivered', '2025-08-30 23:24:25.016236', '9c90c82b7a7645a19555542c06580135', None, 'b46ec23271384895a3350e742110479a')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "event_type": "distribution_update_error", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "9c90c82b-7a76-45a1-9555-542c06580135", "error": "(sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('90a74a9e51e249eab8164a377a4323b3', <TrackStateStatus.received: 'received'>, 'Tamale Teaching Hospital 2', 'Distribution status changed from pending receive to delivered', '2025-08-30 23:24:25.016236', '9c90c82b7a7645a19555542c06580135', None, 'b46ec23271384895a3350e742110479a')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "duration_ms": 54.2299747467041, "timestamp": "2025-08-30T23:24:25.119330Z", "environment": "development", "request_id": "8f2e5fa7-306a-4db7-9eba-96a387d6d6ae", "service": "blood-bank-api", "exception": {"type": "IntegrityError", "message": "(sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('90a74a9e51e249eab8164a377a4323b3', <TrackStateStatus.received: 'received'>, 'Tamale Teaching Hospital 2', 'Distribution status changed from pending receive to delivered', '2025-08-30 23:24:25.016236', '9c90c82b7a7645a19555542c06580135', None, 'b46ec23271384895a3350e742110479a')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\n", "sqlite3.IntegrityError: NOT NULL constraint failed: track_states.blood_request_id\n", "\nThe above exception was the direct cause of the following exception:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\distribution.py\", line 788, in update_distribution\n    updated_distribution = await distribution_service.update_distribution(\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        distribution_id, distribution_data\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\distribution.py\", line 207, in update_distribution\n    await self.db.commit()\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 1015, in commit\n    await greenlet_spawn(self.sync_session.commit)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2032, in commit\n    trans.commit(_to_root=True)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^\n", "  File \"<string>\", line 2, in commit\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n    ~~~~~~~~~~~~~~~~~~^^\n", "  File \"<string>\", line 2, in _prepare_impl\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n    ~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4353, in flush\n    self._flush(objects)\n    ~~~~~~~~~~~^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4488, in _flush\n    with util.safe_reraise():\n         ~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4449, in _flush\n    flush_context.execute()\n    ~~~~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n    ~~~~~~~~~~~^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self.mapper,\n        ^^^^^^^^^^^^\n        uow.states_for_mapper_hierarchy(self.mapper, False, False),\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        uow,\n        ^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        base_mapper,\n        ^^^^^^^^^^^^\n    ...<3 lines>...\n        insert,\n        ^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n        statement,\n        params,\n        execution_options=execution_options,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\n", "sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('90a74a9e51e249eab8164a377a4323b3', <TrackStateStatus.received: 'received'>, 'Tamale Teaching Hospital 2', 'Distribution status changed from pending receive to delivered', '2025-08-30 23:24:25.016236', '9c90c82b7a7645a19555542c06580135', None, 'b46ec23271384895a3350e742110479a')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\n"]}}
{"asctime": "2025-08-30 23:40:40,700", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T23:40:40.700694Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:45:38,585", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T23:45:38.586844Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:50:36,963", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T23:50:36.963657Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-30 23:55:37,477", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-30T23:55:37.478772Z", "environment": "development", "service": "blood-bank-api"}
