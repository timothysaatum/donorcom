{"asctime": "2025-08-29 13:56:27,569", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: token_refresh_failed", "extra_fields": {"event_type": "token_refresh_failed", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "reason": "invalid_refresh_token", "duration_ms": 6.73675537109375}, "timestamp": "2025-08-29T13:56:27.569412Z", "environment": "development", "request_id": "13bcad0b-cf11-41eb-a3fe-d6c8990b4432", "service": "blood-bank-api", "event_type": "token_refresh_failed", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "reason": "invalid_refresh_token", "duration_ms": 6.73675537109375}
{"asctime": "2025-08-29 14:10:13,821", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: token_refresh_success", "extra_fields": {"event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "ddb50fa8-e847-46f6-9271-3dd05bb10fad", "duration_ms": 491.9431209564209, "new_tokens_created": true, "old_token_revoked": true, "session_id": "b3d156b5-ee2d-4cc2-ae14-43fa06b5a88f"}, "timestamp": "2025-08-29T14:10:13.821320Z", "environment": "development", "request_id": "13415efe-d565-4449-ae43-218c4b79b311", "service": "blood-bank-api", "event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "ddb50fa8-e847-46f6-9271-3dd05bb10fad", "duration_ms": 491.9431209564209, "new_tokens_created": true, "old_token_revoked": true, "session_id": "b3d156b5-ee2d-4cc2-ae14-43fa06b5a88f"}
{"asctime": "2025-08-29 16:21:14,318", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: authentication_failed", "extra_fields": {"event_type": "authentication_failed", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "reason": "user_not_found", "email": "hemolync@gmail.com"}, "timestamp": "2025-08-29T16:21:14.318430Z", "environment": "development", "request_id": "d42e221e-525c-4017-9ca6-cdd86482dcac", "service": "blood-bank-api", "event_type": "authentication_failed", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "reason": "user_not_found", "email": "hemolync@gmail.com"}
{"asctime": "2025-08-29 16:23:20,105", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: authentication_failed", "extra_fields": {"event_type": "authentication_failed", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "reason": "user_not_found", "email": "hemolync@gmail.com"}, "timestamp": "2025-08-29T16:23:20.105150Z", "environment": "development", "request_id": "f2dfa6ed-694e-4447-ae2e-184943d5b90d", "service": "blood-bank-api", "event_type": "authentication_failed", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "reason": "user_not_found", "email": "hemolync@gmail.com"}
{"asctime": "2025-08-29 16:25:06,695", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "last_login": "2025-08-29T16:25:06.555809+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-29T16:25:06.695342Z", "environment": "development", "request_id": "a4d82fb5-3aa3-48e7-90f2-303bb3aa1cd4", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "last_login": "2025-08-29T16:25:06.555809+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-29 16:30:41,017", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_update_error", "extra_fields": {"event_type": "facility_update_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "reason": "unexpected_error", "error": "'Facility' object has no attribute 'name'", "facility_id": "8795266d-4f8d-4f5b-b2d0-794c60083c3c", "duration_ms": 6.28209114074707}, "timestamp": "2025-08-29T16:30:41.017321Z", "environment": "development", "request_id": "cbb32af8-617d-492a-a955-9710fe4b81b5", "user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "service": "blood-bank-api", "event_type": "facility_update_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "reason": "unexpected_error", "error": "'Facility' object has no attribute 'name'", "facility_id": "8795266d-4f8d-4f5b-b2d0-794c60083c3c", "duration_ms": 6.28209114074707}
{"asctime": "2025-08-29 16:34:02,421", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_updated", "extra_fields": {"event_type": "facility_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "facility_name": "One Heart", "facility_id": "8795266d-4f8d-4f5b-b2d0-794c60083c3c", "duration_ms": 90.23594856262207, "fields_updated": ["facility_name"]}, "timestamp": "2025-08-29T16:34:02.422070Z", "environment": "development", "request_id": "e177c3b7-239b-47ff-87a3-30806e9966b6", "user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "service": "blood-bank-api", "event_type": "facility_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "facility_name": "One Heart", "facility_id": "8795266d-4f8d-4f5b-b2d0-794c60083c3c", "duration_ms": 90.23594856262207, "fields_updated": ["facility_name"]}
{"asctime": "2025-08-29 16:42:22,980", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_updated", "extra_fields": {"event_type": "facility_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "facility_name": "One Heart", "facility_id": "8795266d-4f8d-4f5b-b2d0-794c60083c3c", "duration_ms": 52.47950553894043, "fields_updated": ["facility_name"]}, "timestamp": "2025-08-29T16:42:22.981336Z", "environment": "development", "request_id": "7f325b5a-087d-4398-91ed-1e283a1b314c", "user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "service": "blood-bank-api", "event_type": "facility_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "facility_name": "One Heart", "facility_id": "8795266d-4f8d-4f5b-b2d0-794c60083c3c", "duration_ms": 52.47950553894043, "fields_updated": ["facility_name"]}
{"asctime": "2025-08-29 16:42:48,971", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_deleted", "extra_fields": {"event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "facility_name": "One Heart", "duration_ms": 230.3617000579834}, "timestamp": "2025-08-29T16:42:48.971155Z", "environment": "development", "request_id": "a8ae75c1-dba5-4c11-ab5e-4529c1946816", "user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "service": "blood-bank-api", "event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "96b1e086-6340-4005-bced-dd85be2a380d", "facility_name": "One Heart", "duration_ms": 230.3617000579834}
{"asctime": "2025-08-29 16:43:25,246", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "last_login": "2025-08-29T16:43:25.135861+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-29T16:43:25.246804Z", "environment": "development", "request_id": "04e9df77-4cc2-4028-9a9b-04c3f9f36113", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "last_login": "2025-08-29T16:43:25.135861+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-29 16:44:40,222", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_deleted", "extra_fields": {"event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital 2", "duration_ms": 218.9157009124756}, "timestamp": "2025-08-29T16:44:40.222251Z", "environment": "development", "request_id": "a9d52306-6630-496b-aad8-6ded1b96dbb4", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital 2", "duration_ms": 218.9157009124756}
{"asctime": "2025-08-29 16:53:44,621", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_created", "extra_fields": {"event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "c386779c-e5df-4372-ab60-a1bc9747d9b1", "blood_bank_created": true, "duration_ms": 185.90021133422852}, "timestamp": "2025-08-29T16:53:44.621952Z", "environment": "development", "request_id": "f32d0270-d3a8-4790-a4f4-3c9acf82b116", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "c386779c-e5df-4372-ab60-a1bc9747d9b1", "blood_bank_created": true, "duration_ms": 185.90021133422852}
{"asctime": "2025-08-29 16:55:12,695", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_deleted", "extra_fields": {"event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "duration_ms": 152.77862548828125}, "timestamp": "2025-08-29T16:55:12.695956Z", "environment": "development", "request_id": "8a7b3282-125d-43c8-a39c-101ad382a6a7", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "duration_ms": 152.77862548828125}
{"asctime": "2025-08-29 16:55:22,686", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_created", "extra_fields": {"event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "9ec632ec-4257-4e97-8434-aec647d175a7", "blood_bank_created": true, "duration_ms": 181.9019317626953}, "timestamp": "2025-08-29T16:55:22.686110Z", "environment": "development", "request_id": "c219426f-39b7-498f-9950-c95b99a499d8", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "9ec632ec-4257-4e97-8434-aec647d175a7", "blood_bank_created": true, "duration_ms": 181.9019317626953}
{"asctime": "2025-08-29 16:55:22,694", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_creation_error", "extra_fields": {"event_type": "facility_with_blood_bank_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "unexpected_error", "error": "'BloodBankBase' object has no attribute 'get'", "facility_name": "Tamale Teaching Hospital", "duration_ms": 183.0728054046631}, "timestamp": "2025-08-29T16:55:22.694807Z", "environment": "development", "request_id": "c219426f-39b7-498f-9950-c95b99a499d8", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "unexpected_error", "error": "'BloodBankBase' object has no attribute 'get'", "facility_name": "Tamale Teaching Hospital", "duration_ms": 183.0728054046631}
{"asctime": "2025-08-29 16:57:03,066", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_created", "extra_fields": {"event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "13d0207c-55e6-411e-9c7e-d63ee91b5224", "blood_bank_created": true, "duration_ms": 146.47388458251953}, "timestamp": "2025-08-29T16:57:03.066947Z", "environment": "development", "request_id": "961a8fc3-ae56-44e5-b4d3-8d34aa6d9662", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "13d0207c-55e6-411e-9c7e-d63ee91b5224", "blood_bank_created": true, "duration_ms": 146.47388458251953}
{"asctime": "2025-08-29 16:57:03,072", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_creation_error", "extra_fields": {"event_type": "facility_with_blood_bank_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "unexpected_error", "error": "'BloodBankBase' object is not subscriptable", "facility_name": "Tamale Teaching Hospital", "duration_ms": 147.6736068725586}, "timestamp": "2025-08-29T16:57:03.072963Z", "environment": "development", "request_id": "961a8fc3-ae56-44e5-b4d3-8d34aa6d9662", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "unexpected_error", "error": "'BloodBankBase' object is not subscriptable", "facility_name": "Tamale Teaching Hospital", "duration_ms": 147.6736068725586}
{"asctime": "2025-08-29 16:58:06,395", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_created", "extra_fields": {"event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "53ffb88c-1257-4d47-ad70-ad918901de16", "blood_bank_created": true, "duration_ms": 170.5949306488037}, "timestamp": "2025-08-29T16:58:06.395159Z", "environment": "development", "request_id": "edd1437c-528b-40a7-8731-572f0b1206f8", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "53ffb88c-1257-4d47-ad70-ad918901de16", "blood_bank_created": true, "duration_ms": 170.5949306488037}
{"asctime": "2025-08-29 16:59:15,746", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_created", "extra_fields": {"event_type": "facility_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Komfo Anokye Teaching Hospital", "facility_id": "c48800df-a2fe-4e5f-a84e-504b97d051bc", "duration_ms": 115.8907413482666}, "timestamp": "2025-08-29T16:59:15.746921Z", "environment": "development", "request_id": "f0428ae3-c3f5-4900-b920-0fa78e8d1659", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Komfo Anokye Teaching Hospital", "facility_id": "c48800df-a2fe-4e5f-a84e-504b97d051bc", "duration_ms": 115.8907413482666}
{"asctime": "2025-08-29 16:59:34,562", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_created", "extra_fields": {"event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "322eeb47-adad-475a-bf24-d7bb7e4db560", "blood_bank_created": true, "duration_ms": 176.29384994506836}, "timestamp": "2025-08-29T16:59:34.562788Z", "environment": "development", "request_id": "9aa4d7a4-a47b-4a26-8013-91734adf72cf", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "facility_name": "Tamale Teaching Hospital", "facility_id": "322eeb47-adad-475a-bf24-d7bb7e4db560", "blood_bank_created": true, "duration_ms": 176.29384994506836}
{"asctime": "2025-08-29 17:00:24,843", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_update_denied", "extra_fields": {"event_type": "facility_update_denied", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "insufficient_permissions", "facility_id": "4cfc92cb-ae8d-4ce4-8ea4-1502c5e97637", "facility_manager_id": "ddb50fa8-e847-46f6-9271-3dd05bb10fad", "requesting_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1"}, "timestamp": "2025-08-29T17:00:24.843533Z", "environment": "development", "request_id": "8e94f008-5ddc-477f-9c5e-5862cfef01b1", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_update_denied", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "insufficient_permissions", "facility_id": "4cfc92cb-ae8d-4ce4-8ea4-1502c5e97637", "facility_manager_id": "ddb50fa8-e847-46f6-9271-3dd05bb10fad", "requesting_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1"}
{"asctime": "2025-08-29 17:00:38,307", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_deletion_denied", "extra_fields": {"event_type": "facility_deletion_denied", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "insufficient_permissions", "facility_id": "4cfc92cb-ae8d-4ce4-8ea4-1502c5e97637", "facility_manager_id": "ddb50fa8-e847-46f6-9271-3dd05bb10fad", "requesting_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1"}, "timestamp": "2025-08-29T17:00:38.307316Z", "environment": "development", "request_id": "4685f030-e8bd-41b5-88c0-c6a897abeba6", "user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "service": "blood-bank-api", "event_type": "facility_deletion_denied", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1", "reason": "insufficient_permissions", "facility_id": "4cfc92cb-ae8d-4ce4-8ea4-1502c5e97637", "facility_manager_id": "ddb50fa8-e847-46f6-9271-3dd05bb10fad", "requesting_user_id": "dfa68a60-9a4f-4d5a-a0c6-e72a03b1a3d1"}
{"asctime": "2025-08-29 19:02:15,027", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "last_login": "2025-08-29T19:02:14.909771+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-29T19:02:15.027236Z", "environment": "development", "request_id": "c03a551e-4a18-4da3-89f8-24dfdbf3650d", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "last_login": "2025-08-29T19:02:14.909771+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-29 19:05:00,310", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: batch_blood_units_created", "extra_fields": {"event_type": "batch_blood_units_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "created_count": 3, "requested_count": 3, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 147.62163162231445, "success_rate": 100.0}, "timestamp": "2025-08-29T19:05:00.310995Z", "environment": "development", "request_id": "d6c1017c-f2b1-4dff-9cd3-605d77960471", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "batch_blood_units_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "created_count": 3, "requested_count": 3, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 147.62163162231445, "success_rate": 100.0}
{"asctime": "2025-08-29 19:05:47,057", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_unit_created", "extra_fields": {"event_type": "blood_unit_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "blood_unit_id": "3192d724-2a09-4e25-ae85-297cf5f6c3d7", "blood_type": "B+", "blood_product": "Platelets", "quantity": 5, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 206.0396671295166}, "timestamp": "2025-08-29T19:05:47.058123Z", "environment": "development", "request_id": "659a6818-7f7b-4bee-bb83-184cb6a486dc", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "blood_unit_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "blood_unit_id": "3192d724-2a09-4e25-ae85-297cf5f6c3d7", "blood_type": "B+", "blood_product": "Platelets", "quantity": 5, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 206.0396671295166}
{"asctime": "2025-08-29 21:03:15,398", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "last_login": "2025-08-29T21:03:15.201982+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-29T21:03:15.399026Z", "environment": "development", "request_id": "b87f6d12-847e-4201-838f-247950934226", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "last_login": "2025-08-29T21:03:15.201982+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-29 21:07:29,976", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_unit_updated", "extra_fields": {"event_type": "blood_unit_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "blood_unit_id": "3192d724-2a09-4e25-ae85-297cf5f6c3d7", "duration_ms": 142.73619651794434, "fields_updated": ["quantity"]}, "timestamp": "2025-08-29T21:07:29.976448Z", "environment": "development", "request_id": "61d18384-673b-41ad-ae37-939662428140", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "blood_unit_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "blood_unit_id": "3192d724-2a09-4e25-ae85-297cf5f6c3d7", "duration_ms": 142.73619651794434, "fields_updated": ["quantity"]}
{"asctime": "2025-08-29 21:07:50,807", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_unit_deleted", "extra_fields": {"event_type": "blood_unit_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "blood_unit_id": "3192d724-2a09-4e25-ae85-297cf5f6c3d7", "blood_type": "B+", "blood_product": "Platelets", "duration_ms": 231.94169998168945}, "timestamp": "2025-08-29T21:07:50.807927Z", "environment": "development", "request_id": "8d4119c4-4644-4078-aa92-b19bf159f1e1", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "blood_unit_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "blood_unit_id": "3192d724-2a09-4e25-ae85-297cf5f6c3d7", "blood_type": "B+", "blood_product": "Platelets", "duration_ms": 231.94169998168945}
{"asctime": "2025-08-29 21:10:33,014", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: batch_blood_units_deleted", "extra_fields": {"event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "deleted_count": 1, "requested_count": 2, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 119.41218376159668, "unit_ids": ["3192d724-2a09-4e25-ae85-297cf5f6c3d7", "19216c6a-f7f0-4af6-8b71-531c28130f72"]}, "timestamp": "2025-08-29T21:10:33.014723Z", "environment": "development", "request_id": "e03bb8be-910b-47ae-97b7-efaf1187aeb2", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "deleted_count": 1, "requested_count": 2, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 119.41218376159668, "unit_ids": ["3192d724-2a09-4e25-ae85-297cf5f6c3d7", "19216c6a-f7f0-4af6-8b71-531c28130f72"]}
{"asctime": "2025-08-29 21:12:43,413", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: batch_blood_units_deleted", "extra_fields": {"event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "deleted_count": 0, "requested_count": 2, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 15.66934585571289, "unit_ids": ["3192d724-2a09-4e25-ae85-297cf5f6c3d7", "19216c6a-f7f0-4af6-8b71-531c28130f72"]}, "timestamp": "2025-08-29T21:12:43.413104Z", "environment": "development", "request_id": "afa200be-3bba-4e2b-8a01-fa659e31468b", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "deleted_count": 0, "requested_count": 2, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 15.66934585571289, "unit_ids": ["3192d724-2a09-4e25-ae85-297cf5f6c3d7", "19216c6a-f7f0-4af6-8b71-531c28130f72"]}
{"asctime": "2025-08-29 21:14:52,571", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: batch_blood_units_deleted", "extra_fields": {"event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "deleted_count": 2, "requested_count": 2, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 120.61691284179688, "unit_ids": ["956d38a9-56e5-4d24-8488-1510e6bc4c1e", "d7c3dab4-ca05-4577-82d5-e6924bb58a23"]}, "timestamp": "2025-08-29T21:14:52.571213Z", "environment": "development", "request_id": "85a01b41-3a5a-4850-ab60-1c6b77a07b8b", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "deleted_count": 2, "requested_count": 2, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 120.61691284179688, "unit_ids": ["956d38a9-56e5-4d24-8488-1510e6bc4c1e", "d7c3dab4-ca05-4577-82d5-e6924bb58a23"]}
{"asctime": "2025-08-29 21:20:05,918", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: inventory_exported", "extra_fields": {"event_type": "inventory_exported", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "export_type": "csv", "records_exported": 10, "blood_type_filter": null, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 22.74489402770996}, "timestamp": "2025-08-29T21:20:05.918200Z", "environment": "development", "request_id": "df605051-18b3-4f53-9d54-a0a8b0bbe768", "user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "service": "blood-bank-api", "event_type": "inventory_exported", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "export_type": "csv", "records_exported": 10, "blood_type_filter": null, "blood_bank_id": "7d330574-4401-48b8-b73a-2d3d2495e6e6", "duration_ms": 22.74489402770996}
{"asctime": "2025-08-29 21:35:54,387", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "last_login": "2025-08-29T21:35:54.236921+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-29T21:35:54.387198Z", "environment": "development", "request_id": "67fb118f-ba60-4860-8e21-9ee38cf8ebe0", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "100e6b18-23dd-45b9-b179-8b4355738819", "last_login": "2025-08-29T21:35:54.236921+00:00", "failed_attempts_reset": true}
