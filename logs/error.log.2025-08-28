{"asctime": "2025-08-28 11:18:14,812", "levelname": "ERROR", "name": "app.middlewares.logging_middleware", "funcName": "dispatch", "lineno": 141, "message": "Request failed: POST /api/blood-inventory/advanced-search", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 144, in simple_response\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 291, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\dependencies\\utils.py\", line 640, in solve_dependencies\n    solved = await run_in_threadpool(call, **solved_result.values)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\concurrency.py\", line 37, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\inventory.py\", line 57, in get_pagination_params\n    return PaginationParams(\n        page=page,\n    ...<2 lines>...\n        sort_order=sort_order\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\npydantic_core._pydantic_core.ValidationError: 1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value='blood_types', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "extra_fields": {"http_method": "POST", "path": "/api/blood-inventory/advanced-search", "error_type": "ValidationError", "error_message": "1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value='blood_types', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "response_time_seconds": 0.0047, "client_ip": "127.0.0.1", "action": "request_failed"}, "timestamp": "2025-08-28T11:18:15.631941Z", "environment": "development", "request_id": "d00157aa-2bbf-4161-9ebe-174542d35f9f", "user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "service": "blood-bank-api", "exception": {"type": "ValidationError", "message": "1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value='blood_types', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 144, in simple_response\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 291, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\dependencies\\utils.py\", line 640, in solve_dependencies\n    solved = await run_in_threadpool(call, **solved_result.values)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\concurrency.py\", line 37, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\inventory.py\", line 57, in get_pagination_params\n    return PaginationParams(\n        page=page,\n    ...<2 lines>...\n        sort_order=sort_order\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value='blood_types', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error\n"]}, "http_method": "POST", "path": "/api/blood-inventory/advanced-search", "error_type": "ValidationError", "error_message": "1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value='blood_types', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "response_time_seconds": 0.0047, "client_ip": "127.0.0.1", "action": "request_failed"}
{"asctime": "2025-08-28 11:19:00,283", "levelname": "ERROR", "name": "app.middlewares.logging_middleware", "funcName": "dispatch", "lineno": 141, "message": "Request failed: POST /api/blood-inventory/advanced-search", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 144, in simple_response\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 291, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\dependencies\\utils.py\", line 640, in solve_dependencies\n    solved = await run_in_threadpool(call, **solved_result.values)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\concurrency.py\", line 37, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\inventory.py\", line 57, in get_pagination_params\n    return PaginationParams(\n        page=page,\n    ...<2 lines>...\n        sort_order=sort_order\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\npydantic_core._pydantic_core.ValidationError: 1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value=' created_at', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "extra_fields": {"http_method": "POST", "path": "/api/blood-inventory/advanced-search", "error_type": "ValidationError", "error_message": "1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value=' created_at', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "response_time_seconds": 0.0038, "client_ip": "127.0.0.1", "action": "request_failed"}, "timestamp": "2025-08-28T11:19:00.329465Z", "environment": "development", "request_id": "5f52c1be-0414-4d46-8553-d592781d66b1", "user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "service": "blood-bank-api", "exception": {"type": "ValidationError", "message": "1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value=' created_at', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 144, in simple_response\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 291, in app\n    solved_result = await solve_dependencies(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\dependencies\\utils.py\", line 640, in solve_dependencies\n    solved = await run_in_threadpool(call, **solved_result.values)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\concurrency.py\", line 37, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\inventory.py\", line 57, in get_pagination_params\n    return PaginationParams(\n        page=page,\n    ...<2 lines>...\n        sort_order=sort_order\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n", "pydantic_core._pydantic_core.ValidationError: 1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value=' created_at', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error\n"]}, "http_method": "POST", "path": "/api/blood-inventory/advanced-search", "error_type": "ValidationError", "error_message": "1 validation error for PaginationParams\nsort_by\n  Value error, Sort field must be one of: created_at, updated_at, expiry_date, blood_type, blood_product, quantity [type=value_error, input_value=' created_at', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.11/v/value_error", "response_time_seconds": 0.0038, "client_ip": "127.0.0.1", "action": "request_failed"}
{"asctime": "2025-08-28 11:29:18,848", "levelname": "ERROR", "name": "app.services.request", "funcName": "wrapper", "lineno": 43, "message": "create_bulk_request failed after 0.018 seconds: 400: One or more facilities not found", "timestamp": "2025-08-28T11:29:18.851860Z", "environment": "development", "request_id": "f2ad3b1b-4d64-4a11-ab56-00cd03ef5452", "user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "service": "blood-bank-api"}
{"asctime": "2025-08-28 11:35:12,435", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T11:35:12.436205Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 11:35:26,851", "levelname": "ERROR", "name": "app.services.request", "funcName": "wrapper", "lineno": 43, "message": "list_request_groups_by_user failed after 0.010 seconds: 2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "timestamp": "2025-08-28T11:35:26.852565Z", "environment": "development", "request_id": "08e6f540-e207-4223-8442-e0baae260243", "user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "service": "blood-bank-api"}
{"asctime": "2025-08-28 11:35:26,855", "levelname": "ERROR", "name": "app.middlewares.logging_middleware", "funcName": "dispatch", "lineno": 141, "message": "Request failed: GET /api/requests/groups", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 123, in list_my_request_groups\n    return await service.list_request_groups_by_user(user_id=current_user.id)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 36, in wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 534, in list_request_groups_by_user\n    group_response = BloodRequestGroupResponse(\n        request_group_id=group_id,\n    ...<12 lines>...\n        updated_at=max(r.updated_at for r in group_requests)\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\npydantic_core._pydantic_core.ValidationError: 2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "extra_fields": {"http_method": "GET", "path": "/api/requests/groups", "error_type": "ValidationError", "error_message": "2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "response_time_seconds": 0.0426, "client_ip": "127.0.0.1", "action": "request_failed"}, "timestamp": "2025-08-28T11:35:26.906161Z", "environment": "development", "request_id": "08e6f540-e207-4223-8442-e0baae260243", "user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "service": "blood-bank-api", "exception": {"type": "ValidationError", "message": "2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 123, in list_my_request_groups\n    return await service.list_request_groups_by_user(user_id=current_user.id)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 36, in wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 534, in list_request_groups_by_user\n    group_response = BloodRequestGroupResponse(\n        request_group_id=group_id,\n    ...<12 lines>...\n        updated_at=max(r.updated_at for r in group_requests)\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n", "pydantic_core._pydantic_core.ValidationError: 2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\n"]}, "http_method": "GET", "path": "/api/requests/groups", "error_type": "ValidationError", "error_message": "2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "response_time_seconds": 0.0426, "client_ip": "127.0.0.1", "action": "request_failed"}
{"asctime": "2025-08-28 11:40:09,206", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T11:40:09.207654Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 11:43:40,258", "levelname": "ERROR", "name": "app.services.request", "funcName": "wrapper", "lineno": 43, "message": "list_request_groups_by_user failed after 0.015 seconds: 2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "timestamp": "2025-08-28T11:43:40.259304Z", "environment": "development", "request_id": "5af13ee9-cfbf-4999-a81f-0b82a2d9d31a", "user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "service": "blood-bank-api"}
{"asctime": "2025-08-28 11:43:40,262", "levelname": "ERROR", "name": "app.middlewares.logging_middleware", "funcName": "dispatch", "lineno": 141, "message": "Request failed: GET /api/requests/groups", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 123, in list_my_request_groups\n    return await service.list_request_groups_by_user(user_id=current_user.id)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 36, in wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 555, in list_request_groups_by_user\n    group_response = BloodRequestGroupResponse(\n        request_group_id=group_id,\n    ...<12 lines>...\n        updated_at=max(r.updated_at for r in group_requests)\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\npydantic_core._pydantic_core.ValidationError: 2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "extra_fields": {"http_method": "GET", "path": "/api/requests/groups", "error_type": "ValidationError", "error_message": "2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "response_time_seconds": 0.0734, "client_ip": "127.0.0.1", "action": "request_failed"}, "timestamp": "2025-08-28T11:43:40.310082Z", "environment": "development", "request_id": "5af13ee9-cfbf-4999-a81f-0b82a2d9d31a", "user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "service": "blood-bank-api", "exception": {"type": "ValidationError", "message": "2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 147, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\n", "anyio.EndOfStream\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\middlewares\\logging_middleware.py\", line 75, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 173, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n                                   ~~~~~~~~~~~~~~~~~~^^\n", "  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.2032.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_utils.py\", line 82, in collapse_excgroups\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 175, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\main.py\", line 73, in https_redirect\n    return await call_next(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 153, in call_next\n    raise app_exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 140, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 714, in __call__\n    await self.middleware_stack(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 734, in app\n    await route.handle(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\starlette\\routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\fastapi\\routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\request.py\", line 123, in list_my_request_groups\n    return await service.list_request_groups_by_user(user_id=current_user.id)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 36, in wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\request.py\", line 555, in list_request_groups_by_user\n    group_response = BloodRequestGroupResponse(\n        request_group_id=group_id,\n    ...<12 lines>...\n        updated_at=max(r.updated_at for r in group_requests)\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\pydantic\\main.py\", line 243, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n", "pydantic_core._pydantic_core.ValidationError: 2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\n"]}, "http_method": "GET", "path": "/api/requests/groups", "error_type": "ValidationError", "error_message": "2 validation errors for BloodRequestGroupResponse\napproved_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing\nfulfilled_count\n  Field required [type=missing, input_value={'request_group_id': UUID...2025, 8, 28, 11, 32, 9)}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.11/v/missing", "response_time_seconds": 0.0734, "client_ip": "127.0.0.1", "action": "request_failed"}
{"asctime": "2025-08-28 11:49:48,897", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T11:49:48.897571Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 11:54:49,523", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T11:54:49.523576Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 11:59:49,963", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T11:59:49.963949Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 14:44:50,610", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T14:44:50.612577Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 14:49:49,607", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T14:49:49.608046Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 14:54:50,515", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T14:54:50.515550Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 14:59:48,606", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T14:59:48.606961Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 15:29:09,760", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T15:29:09.761035Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 15:53:30,331", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T15:53:30.331495Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 15:58:31,284", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T15:58:31.284763Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 16:03:30,614", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T16:03:30.614878Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 16:08:30,397", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T16:08:30.398138Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 16:13:31,595", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T16:13:31.595542Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 16:18:33,148", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T16:18:33.148799Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 16:46:49,218", "levelname": "ERROR", "name": "facility_gps", "funcName": "fetch_and_update_facilities", "lineno": 93, "message": "Error updating facility coordinates: 'NoneType' object is not subscriptable", "timestamp": "2025-08-28T16:46:49.218797Z", "environment": "development", "service": "blood-bank-api"}
{"asctime": "2025-08-28 16:49:37,186", "levelname": "ERROR", "name": "app.routes.users", "funcName": "verify_email", "lineno": 362, "message": "Email verification failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\nsqlite3.OperationalError: no such column: users.is_banned\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\users.py\", line 218, in verify_email\n    result = await db.execute(select(User).where(User.email == email))\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 463, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 201, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n           ~~~~~~~~~~~~~~~~~~~~~~^\n        statement,\n        ^^^^^^^^^^\n    ...<4 lines>...\n        _add_event=_add_event,\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self,\n        ^^^^^\n    ...<4 lines>...\n        conn,\n        ^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n        statement, params or {}, execution_options=execution_options\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.is_banned\n[SQL: SELECT users.id, users.first_name, users.last_name, users.email, users.password, users.phone, users.is_active, users.status, users.work_facility_id, users.is_verified, users.is_banned, users.is_suspended, users.verification_token, users.failed_login_attempts, users.locked_until, users.created_at, users.updated_at, users.last_login \nFROM users \nWHERE users.email = ?]\n[parameters: ('hemolync.inc@gmail.com',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "event_type": "email_verification_error", "error": "(sqlite3.OperationalError) no such column: users.is_banned\n[SQL: SELECT users.id, users.first_name, users.last_name, users.email, users.password, users.phone, users.is_active, users.status, users.work_facility_id, users.is_verified, users.is_banned, users.is_suspended, users.verification_token, users.failed_login_attempts, users.locked_until, users.created_at, users.updated_at, users.last_login \nFROM users \nWHERE users.email = ?]\n[parameters: ('hemolync.inc@gmail.com',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "duration_ms": 10.650396347045898, "timestamp": "2025-08-28T16:49:37.782270Z", "environment": "development", "request_id": "3893343c-267d-4bfe-8185-a7f0d60569af", "service": "blood-bank-api", "exception": {"type": "OperationalError", "message": "(sqlite3.OperationalError) no such column: users.is_banned\n[SQL: SELECT users.id, users.first_name, users.last_name, users.email, users.password, users.phone, users.is_active, users.status, users.work_facility_id, users.is_verified, users.is_banned, users.is_suspended, users.verification_token, users.failed_login_attempts, users.locked_until, users.created_at, users.updated_at, users.last_login \nFROM users \nWHERE users.email = ?]\n[parameters: ('hemolync.inc@gmail.com',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\n", "sqlite3.OperationalError: no such column: users.is_banned\n", "\nThe above exception was the direct cause of the following exception:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\users.py\", line 218, in verify_email\n    result = await db.execute(select(User).where(User.email == email))\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 463, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n    ...<6 lines>...\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 201, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2365, in execute\n    return self._execute_internal(\n           ~~~~~~~~~~~~~~~~~~~~~~^\n        statement,\n        ^^^^^^^^^^\n    ...<4 lines>...\n        _add_event=_add_event,\n        ^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self,\n        ^^^^^\n    ...<4 lines>...\n        conn,\n        ^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n        statement, params or {}, execution_options=execution_options\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n        self,\n        distilled_parameters,\n        execution_options or NO_OPTIONS,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        self, distilled_params, execution_options\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n        dialect,\n    ...<8 lines>...\n        cache_hit=cache_hit,\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ~~~~~~~~~~~~~~~~~~~~~~~~~^\n        dialect, context, statement, parameters\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        e, str_statement, effective_parameters, cursor, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n    ~~~~~~~~~~~~~~~~~~~~~~~^\n        cursor, str_statement, effective_parameters, context\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 172, in execute\n    self._adapt_connection._handle_exception(error)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 323, in _handle_exception\n    raise error\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 154, in execute\n    self.await_(_cursor.execute(operation, parameters))\n    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 32, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 122, in _execute\n    return await future\n           ^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\donorenv\\Lib\\site-packages\\aiosqlite\\core.py\", line 105, in run\n    result = function()\n", "sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.is_banned\n[SQL: SELECT users.id, users.first_name, users.last_name, users.email, users.password, users.phone, users.is_active, users.status, users.work_facility_id, users.is_verified, users.is_banned, users.is_suspended, users.verification_token, users.failed_login_attempts, users.locked_until, users.created_at, users.updated_at, users.last_login \nFROM users \nWHERE users.email = ?]\n[parameters: ('hemolync.inc@gmail.com',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n"]}}
{"asctime": "2025-08-28 20:15:03,238", "levelname": "ERROR", "name": "app.routes.auth", "funcName": "login", "lineno": 252, "message": "Login failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?", "extra_fields": {"email": "hemolync.inc@gmail.com", "client_ip": "127.0.0.1", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 759.4587802886963, "action": "login_error"}, "timestamp": "2025-08-28T20:15:03.362486Z", "environment": "development", "request_id": "5e3b35e5-d490-4f68-896a-b1d1962f0df2", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?\n"]}, "email": "hemolync.inc@gmail.com", "client_ip": "127.0.0.1", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 759.4587802886963, "action": "login_error"}
{"asctime": "2025-08-28 20:15:03,364", "levelname": "ERROR", "name": "app.routes.auth", "funcName": "async_wrapper", "lineno": 279, "message": "Error in login: 500: Login failed", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\utils\\logging_config.py\", line 251, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 277, in login\n    raise HTTPException(status_code=500, detail=\"Login failed\")\nfastapi.exceptions.HTTPException: 500: Login failed", "extra_fields": {"function": "login", "module": "app.routes.auth", "action": "function_error", "execution_time_seconds": 0.8864, "status": "error", "error_type": "HTTPException", "error_message": "500: Login failed"}, "timestamp": "2025-08-28T20:15:03.403327Z", "environment": "development", "request_id": "5e3b35e5-d490-4f68-896a-b1d1962f0df2", "service": "blood-bank-api", "exception": {"type": "HTTPException", "message": "500: Login failed", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\utils\\logging_config.py\", line 251, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 277, in login\n    raise HTTPException(status_code=500, detail=\"Login failed\")\n", "fastapi.exceptions.HTTPException: 500: Login failed\n"]}, "function": "login", "module": "app.routes.auth", "action": "function_error", "execution_time_seconds": 0.8864, "status": "error", "error_type": "HTTPException", "error_message": "500: Login failed"}
{"asctime": "2025-08-28 20:17:12,391", "levelname": "ERROR", "name": "app.routes.auth", "funcName": "login", "lineno": 252, "message": "Login failed due to unexpected error", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?", "extra_fields": {"email": "hemolync.inc@gmail.com", "client_ip": "127.0.0.1", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 665.8904552459717, "action": "login_error"}, "timestamp": "2025-08-28T20:17:12.397022Z", "environment": "development", "request_id": "a8badff8-5965-4e22-9a4a-d4c356f23063", "service": "blood-bank-api", "exception": {"type": "AttributeError", "message": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?\n"]}, "email": "hemolync.inc@gmail.com", "client_ip": "127.0.0.1", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 665.8904552459717, "action": "login_error"}
{"asctime": "2025-08-28 20:17:12,398", "levelname": "ERROR", "name": "app.routes.auth", "funcName": "async_wrapper", "lineno": 279, "message": "Error in login: 500: Login failed", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\utils\\logging_config.py\", line 251, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 277, in login\n    raise HTTPException(status_code=500, detail=\"Login failed\")\nfastapi.exceptions.HTTPException: 500: Login failed", "extra_fields": {"function": "login", "module": "app.routes.auth", "action": "function_error", "execution_time_seconds": 0.6734, "status": "error", "error_type": "HTTPException", "error_message": "500: Login failed"}, "timestamp": "2025-08-28T20:17:12.412281Z", "environment": "development", "request_id": "a8badff8-5965-4e22-9a4a-d4c356f23063", "service": "blood-bank-api", "exception": {"type": "HTTPException", "message": "500: Login failed", "traceback": ["Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 184, in login\n    await JWTSessionService.create_session(\n    ...<4 lines>...\n    )\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\services\\session_manager.py\", line 45, in create_session\n    refresh_token = await JWTSessionService.create_refresh_token(db, user_id, device_info, request.client.host)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "AttributeError: type object 'JWTSessionService' has no attribute 'create_refresh_token'. Did you mean: 'create_access_token'?\n", "\nDuring handling of the above exception, another exception occurred:\n\n", "Traceback (most recent call last):\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\utils\\logging_config.py\", line 251, in async_wrapper\n    result = await func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"C:\\Users\\BARTHOLOMEW\\Desktop\\donorcom\\app\\routes\\auth.py\", line 277, in login\n    raise HTTPException(status_code=500, detail=\"Login failed\")\n", "fastapi.exceptions.HTTPException: 500: Login failed\n"]}, "function": "login", "module": "app.routes.auth", "action": "function_error", "execution_time_seconds": 0.6734, "status": "error", "error_type": "HTTPException", "error_message": "500: Login failed"}
