{"asctime": "2025-08-28 10:55:05,192", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: email_verified", "extra_fields": {"event_type": "email_verified", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "email": "hemolync.inc@gmail.com", "role_assigned": "facility_administrator", "facility_assigned": false, "duration_ms": 108.00671577453613}, "timestamp": "2025-08-28T10:55:05.192998Z", "environment": "development", "request_id": "051f39ce-d598-4f40-a9ba-2c60fe67d7d0", "service": "blood-bank-api", "event_type": "email_verified", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "email": "hemolync.inc@gmail.com", "role_assigned": "facility_administrator", "facility_assigned": false, "duration_ms": 108.00671577453613}
{"asctime": "2025-08-28 10:55:19,517", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "last_login": "2025-08-28T10:55:19.414494+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-28T10:55:19.517469Z", "environment": "development", "request_id": "7a093f60-e2c7-498d-8768-a4a36e0b5bcb", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "last_login": "2025-08-28T10:55:19.414494+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-28 14:44:23,812", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: token_refresh_success", "extra_fields": {"event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "duration_ms": 368.7863349914551, "new_tokens_created": true, "old_token_revoked": true}, "timestamp": "2025-08-28T14:44:23.812319Z", "environment": "development", "request_id": "d39dcdb6-8852-4d2e-a5c8-8af812612712", "service": "blood-bank-api", "event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "ebe8e7c6-398f-4c16-b160-a49c78b0dcd7", "duration_ms": 368.7863349914551, "new_tokens_created": true, "old_token_revoked": true}
{"asctime": "2025-08-28 16:49:37,789", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: email_verification_error", "extra_fields": {"event_type": "email_verification_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "reason": "unexpected_error", "error": "(sqlite3.OperationalError) no such column: users.is_banned\n[SQL: SELECT users.id, users.first_name, users.last_name, users.email, users.password, users.phone, users.is_active, users.status, users.work_facility_id, users.is_verified, users.is_banned, users.is_suspended, users.verification_token, users.failed_login_attempts, users.locked_until, users.created_at, users.updated_at, users.last_login \nFROM users \nWHERE users.email = ?]\n[parameters: ('hemolync.inc@gmail.com',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "duration_ms": 10.650396347045898}, "timestamp": "2025-08-28T16:49:37.789071Z", "environment": "development", "request_id": "3893343c-267d-4bfe-8185-a7f0d60569af", "service": "blood-bank-api", "event_type": "email_verification_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "reason": "unexpected_error", "error": "(sqlite3.OperationalError) no such column: users.is_banned\n[SQL: SELECT users.id, users.first_name, users.last_name, users.email, users.password, users.phone, users.is_active, users.status, users.work_facility_id, users.is_verified, users.is_banned, users.is_suspended, users.verification_token, users.failed_login_attempts, users.locked_until, users.created_at, users.updated_at, users.last_login \nFROM users \nWHERE users.email = ?]\n[parameters: ('hemolync.inc@gmail.com',)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "duration_ms": 10.650396347045898}
{"asctime": "2025-08-28 16:53:05,839", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: user_registered", "extra_fields": {"event_type": "user_registered", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "email": "hemolync.inc@gmail.com", "role": "facility_administrator", "user_id": "b013e98f-b766-4041-af95-92787fa0e030", "duration_ms": 393.34940910339355, "verification_required": true}, "timestamp": "2025-08-28T16:53:05.840029Z", "environment": "development", "request_id": "d5327807-d32a-47ff-8446-a3f8fba4a06d", "service": "blood-bank-api", "event_type": "user_registered", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "email": "hemolync.inc@gmail.com", "role": "facility_administrator", "user_id": "b013e98f-b766-4041-af95-92787fa0e030", "duration_ms": 393.34940910339355, "verification_required": true}
{"asctime": "2025-08-28 16:54:03,041", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: email_verified", "extra_fields": {"event_type": "email_verified", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "email": "hemolync.inc@gmail.com", "role_assigned": "facility_administrator", "facility_assigned": false, "duration_ms": 621.7806339263916}, "timestamp": "2025-08-28T16:54:03.041223Z", "environment": "development", "request_id": "88ed3430-2c07-4caa-80fd-a4e62cffa970", "service": "blood-bank-api", "event_type": "email_verified", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "email": "hemolync.inc@gmail.com", "role_assigned": "facility_administrator", "facility_assigned": false, "duration_ms": 621.7806339263916}
{"asctime": "2025-08-28 16:54:10,876", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T16:54:10.728618+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-28T16:54:10.877000Z", "environment": "development", "request_id": "f146559f-9587-48f4-888c-21ffa542698f", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T16:54:10.728618+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-28 20:15:02,919", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T20:15:02.781399+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-28T20:15:02.920052Z", "environment": "development", "request_id": "5e3b35e5-d490-4f68-896a-b1d1962f0df2", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T20:15:02.781399+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-28 20:15:03,363", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: login_error", "extra_fields": {"event_type": "login_error", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "email": "hemolync.inc@gmail.com", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 759.4587802886963}, "timestamp": "2025-08-28T20:15:03.363321Z", "environment": "development", "request_id": "5e3b35e5-d490-4f68-896a-b1d1962f0df2", "service": "blood-bank-api", "event_type": "login_error", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "email": "hemolync.inc@gmail.com", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 759.4587802886963}
{"asctime": "2025-08-28 20:17:12,101", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T20:17:11.955836+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-28T20:17:12.101888Z", "environment": "development", "request_id": "a8badff8-5965-4e22-9a4a-d4c356f23063", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T20:17:11.955836+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-28 20:17:12,397", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: login_error", "extra_fields": {"event_type": "login_error", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "email": "hemolync.inc@gmail.com", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 665.8904552459717}, "timestamp": "2025-08-28T20:17:12.397772Z", "environment": "development", "request_id": "a8badff8-5965-4e22-9a4a-d4c356f23063", "service": "blood-bank-api", "event_type": "login_error", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "email": "hemolync.inc@gmail.com", "error": "type object 'JWTSessionService' has no attribute 'create_refresh_token'", "duration_ms": 665.8904552459717}
{"asctime": "2025-08-28 22:05:44,186", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T22:05:44.051417+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-28T22:05:44.186742Z", "environment": "development", "request_id": "60fdea2a-f0b0-4d20-ae33-edf273980ccd", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "last_login": "2025-08-28T22:05:44.051417+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-28 22:12:03,856", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: token_refresh_success", "extra_fields": {"event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "duration_ms": 533.3795547485352, "new_tokens_created": true, "old_token_revoked": true, "session_id": "5b652c91-3317-42fc-a9f1-6917f05f6892"}, "timestamp": "2025-08-28T22:12:03.856142Z", "environment": "development", "request_id": "66480340-d89b-47c4-8978-e15373c80bad", "service": "blood-bank-api", "event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b013e98f-b766-4041-af95-92787fa0e030", "duration_ms": 533.3795547485352, "new_tokens_created": true, "old_token_revoked": true, "session_id": "5b652c91-3317-42fc-a9f1-6917f05f6892"}
