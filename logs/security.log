{"asctime": "2025-08-30 10:20:26,083", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: registration_denied", "extra_fields": {"event_type": "registration_denied", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "reason": "restricted_role", "requested_role": "staff", "email": "kwame.adjei@example.com"}, "timestamp": "2025-08-30T10:20:26.098739Z", "environment": "development", "request_id": "b00bef87-9ffe-4d2b-90cc-b1b6ee113984", "service": "blood-bank-api", "event_type": "registration_denied", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "reason": "restricted_role", "requested_role": "staff", "email": "kwame.adjei@example.com"}
{"asctime": "2025-08-30 10:20:51,505", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: user_registered", "extra_fields": {"event_type": "user_registered", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "email": "kwame.adjei@example.com", "role": "facility_administrator", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 823.5197067260742, "verification_required": true}, "timestamp": "2025-08-30T10:20:51.505710Z", "environment": "development", "request_id": "c1bb38cb-d89c-42e0-acbe-be800b24cf28", "service": "blood-bank-api", "event_type": "user_registered", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "email": "kwame.adjei@example.com", "role": "facility_administrator", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 823.5197067260742, "verification_required": true}
{"asctime": "2025-08-30 10:21:28,476", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: email_verified", "extra_fields": {"event_type": "email_verified", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "email": "kwame.adjei@example.com", "role_assigned": "facility_administrator", "facility_assigned": false, "duration_ms": 276.8442630767822}, "timestamp": "2025-08-30T10:21:28.476707Z", "environment": "development", "request_id": "4d9f620f-1194-4fe2-8087-7abdbd387846", "service": "blood-bank-api", "event_type": "email_verified", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "email": "kwame.adjei@example.com", "role_assigned": "facility_administrator", "facility_assigned": false, "duration_ms": 276.8442630767822}
{"asctime": "2025-08-30 10:22:14,319", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "last_login": "2025-08-30T10:22:14.188530+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-30T10:22:14.319403Z", "environment": "development", "request_id": "eb110669-e543-452f-b301-1950056c8dc4", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "last_login": "2025-08-30T10:22:14.188530+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-30 10:23:31,100", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_created", "extra_fields": {"event_type": "facility_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Tamale Central Laboratory", "facility_id": "226fd287-6cea-4241-9c3b-320b07bb2d27", "duration_ms": 127.30622291564941}, "timestamp": "2025-08-30T10:23:31.100965Z", "environment": "development", "request_id": "4bb6d11f-fe68-44c7-8cf3-85671ce549b7", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "facility_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Tamale Central Laboratory", "facility_id": "226fd287-6cea-4241-9c3b-320b07bb2d27", "duration_ms": 127.30622291564941}
{"asctime": "2025-08-30 10:24:37,654", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_updated", "extra_fields": {"event_type": "facility_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Great Labs", "facility_id": "226fd287-6cea-4241-9c3b-320b07bb2d27", "duration_ms": 124.3584156036377, "fields_updated": ["facility_name"]}, "timestamp": "2025-08-30T10:24:37.654874Z", "environment": "development", "request_id": "22beff21-aa44-4683-a267-96e236aba6a3", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "facility_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Great Labs", "facility_id": "226fd287-6cea-4241-9c3b-320b07bb2d27", "duration_ms": 124.3584156036377, "fields_updated": ["facility_name"]}
{"asctime": "2025-08-30 10:25:09,666", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_deleted", "extra_fields": {"event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Great Labs", "duration_ms": 170.86505889892578}, "timestamp": "2025-08-30T10:25:09.666907Z", "environment": "development", "request_id": "033e275f-a8e9-49c8-8970-b32ca886e93a", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "facility_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Great Labs", "duration_ms": 170.86505889892578}
{"asctime": "2025-08-30 10:26:04,422", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: facility_with_blood_bank_created", "extra_fields": {"event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Korle-Bu Teaching Hospital", "facility_id": "1bfee633-9830-4b5b-becd-05f7473084e8", "blood_bank_created": true, "duration_ms": 173.89702796936035}, "timestamp": "2025-08-30T10:26:04.422640Z", "environment": "development", "request_id": "afb66f8b-81d7-4db2-800f-9592d49c18f0", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "facility_with_blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "facility_name": "Korle-Bu Teaching Hospital", "facility_id": "1bfee633-9830-4b5b-becd-05f7473084e8", "blood_bank_created": true, "duration_ms": 173.89702796936035}
{"asctime": "2025-08-30 10:27:27,271", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_bank_updated", "extra_fields": {"event_type": "blood_bank_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_bank_name": "Korlebu Bank1", "blood_bank_id": "eadb69ff-57fe-4029-8b7a-a7cf7bb4e318", "duration_ms": 113.16370964050293, "fields_updated": ["blood_bank_name"]}, "timestamp": "2025-08-30T10:27:27.271834Z", "environment": "development", "request_id": "49ad0cf9-5eb3-47b6-8df8-9d52ebd6a9ff", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_bank_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_bank_name": "Korlebu Bank1", "blood_bank_id": "eadb69ff-57fe-4029-8b7a-a7cf7bb4e318", "duration_ms": 113.16370964050293, "fields_updated": ["blood_bank_name"]}
{"asctime": "2025-08-30 10:27:46,053", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_bank_deleted", "extra_fields": {"event_type": "blood_bank_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_bank_name": "Korlebu Bank1", "facility_id": "1bfee633-9830-4b5b-becd-05f7473084e8", "duration_ms": 146.7583179473877}, "timestamp": "2025-08-30T10:27:46.053814Z", "environment": "development", "request_id": "5334beda-e415-4cb6-8c49-1b2bfeeebcbf", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_bank_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_bank_name": "Korlebu Bank1", "facility_id": "1bfee633-9830-4b5b-becd-05f7473084e8", "duration_ms": 146.7583179473877}
{"asctime": "2025-08-30 10:28:31,936", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_bank_created", "extra_fields": {"event_type": "blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_bank_name": "Korle-Bu Blood Bank", "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "facility_id": "1bfee633-9830-4b5b-becd-05f7473084e8", "duration_ms": 140.78927040100098}, "timestamp": "2025-08-30T10:28:31.936139Z", "environment": "development", "request_id": "214150cd-7700-410a-8b9b-613df58fe388", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_bank_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_bank_name": "Korle-Bu Blood Bank", "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "facility_id": "1bfee633-9830-4b5b-becd-05f7473084e8", "duration_ms": 140.78927040100098}
{"asctime": "2025-08-30 10:29:49,104", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_unit_created", "extra_fields": {"event_type": "blood_unit_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_unit_id": "432c1455-cf47-4a60-a2a9-292f1afdec10", "blood_type": "O+", "blood_product": "Red Blood Cells", "quantity": 5, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 140.16056060791016}, "timestamp": "2025-08-30T10:29:49.104136Z", "environment": "development", "request_id": "cbd4d31b-7046-43a3-899e-7151b74e8b31", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_unit_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_unit_id": "432c1455-cf47-4a60-a2a9-292f1afdec10", "blood_type": "O+", "blood_product": "Red Blood Cells", "quantity": 5, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 140.16056060791016}
{"asctime": "2025-08-30 10:31:25,012", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: batch_blood_units_created", "extra_fields": {"event_type": "batch_blood_units_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "created_count": 4, "requested_count": 4, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 107.56731033325195, "success_rate": 100.0}, "timestamp": "2025-08-30T10:31:25.012914Z", "environment": "development", "request_id": "ba907f3a-830d-463b-8cae-6279b094d8b7", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "batch_blood_units_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "created_count": 4, "requested_count": 4, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 107.56731033325195, "success_rate": 100.0}
{"asctime": "2025-08-30 10:34:06,913", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: batch_blood_units_deleted", "extra_fields": {"event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "deleted_count": 2, "requested_count": 2, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 212.493896484375, "unit_ids": ["432c1455-cf47-4a60-a2a9-292f1afdec10", "ddb27c74-9b92-46c6-b631-6ac4c75cc12f"]}, "timestamp": "2025-08-30T10:34:06.913202Z", "environment": "development", "request_id": "df47c18c-2268-4e74-8c9a-0bce1f41e1fa", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "batch_blood_units_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "deleted_count": 2, "requested_count": 2, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 212.493896484375, "unit_ids": ["432c1455-cf47-4a60-a2a9-292f1afdec10", "ddb27c74-9b92-46c6-b631-6ac4c75cc12f"]}
{"asctime": "2025-08-30 10:34:32,970", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: batch_blood_units_created", "extra_fields": {"event_type": "batch_blood_units_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "created_count": 4, "requested_count": 4, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 171.830415725708, "success_rate": 100.0}, "timestamp": "2025-08-30T10:34:32.970121Z", "environment": "development", "request_id": "190aa950-8ed3-4eba-8849-b06a1707059a", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "batch_blood_units_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "created_count": 4, "requested_count": 4, "blood_bank_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "duration_ms": 171.830415725708, "success_rate": 100.0}
{"asctime": "2025-08-30 10:36:47,659", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_unit_updated", "extra_fields": {"event_type": "blood_unit_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_unit_id": "d1e27a16-ffa0-4cbc-9330-a0549d5a7769", "duration_ms": 185.7762336730957, "fields_updated": ["quantity", "expiry_date"]}, "timestamp": "2025-08-30T10:36:47.659635Z", "environment": "development", "request_id": "ae6cf978-caba-4b7e-89da-5984d1667d9e", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_unit_updated", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_unit_id": "d1e27a16-ffa0-4cbc-9330-a0549d5a7769", "duration_ms": 185.7762336730957, "fields_updated": ["quantity", "expiry_date"]}
{"asctime": "2025-08-30 10:37:05,529", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_unit_deleted", "extra_fields": {"event_type": "blood_unit_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_unit_id": "d1e27a16-ffa0-4cbc-9330-a0549d5a7769", "blood_type": "AB-", "blood_product": "Red Blood Cells", "duration_ms": 159.2705249786377}, "timestamp": "2025-08-30T10:37:05.529635Z", "environment": "development", "request_id": "ef4058a0-3da2-4ef4-a17a-1a75890dc662", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_unit_deleted", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "blood_unit_id": "d1e27a16-ffa0-4cbc-9330-a0549d5a7769", "blood_type": "AB-", "blood_product": "Red Blood Cells", "duration_ms": 159.2705249786377}
{"asctime": "2025-08-30 10:59:22,307", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_request_creation_error", "extra_fields": {"event_type": "blood_request_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequestBulkCreateResponse' object has no attribute 'group_id'", "blood_type": "B+", "duration_ms": 241.68658256530762}, "timestamp": "2025-08-30T10:59:22.307928Z", "environment": "development", "request_id": "597504ee-e791-41dc-a683-b7e65b7c6101", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_request_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequestBulkCreateResponse' object has no attribute 'group_id'", "blood_type": "B+", "duration_ms": 241.68658256530762}
{"asctime": "2025-08-30 15:04:41,027", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: token_refresh_success", "extra_fields": {"event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 1187.814474105835, "new_tokens_created": true, "old_token_revoked": true, "session_id": "37c16a94-9b5c-4730-8e2f-ebf1201314d3"}, "timestamp": "2025-08-30T15:04:41.027708Z", "environment": "development", "request_id": "4f29f00b-eb3c-451a-b553-f3088fec322a", "service": "blood-bank-api", "event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 1187.814474105835, "new_tokens_created": true, "old_token_revoked": true, "session_id": "37c16a94-9b5c-4730-8e2f-ebf1201314d3"}
{"asctime": "2025-08-30 15:20:44,403", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: request_response_error", "extra_fields": {"event_type": "request_response_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequest' object has no attribute 'quantity'", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "duration_ms": 361.8168830871582}, "timestamp": "2025-08-30T15:20:44.404008Z", "environment": "development", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "request_response_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequest' object has no attribute 'quantity'", "duration_ms": 361.8168830871582}
{"asctime": "2025-08-30 15:22:06,592", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: request_response_error", "extra_fields": {"event_type": "request_response_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequest' object has no attribute 'quantity'", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "duration_ms": 82.75818824768066}, "timestamp": "2025-08-30T15:22:06.592601Z", "environment": "development", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "request_response_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequest' object has no attribute 'quantity'", "duration_ms": 82.75818824768066}
{"asctime": "2025-08-30 18:16:54,757", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: token_refresh_success", "extra_fields": {"event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 433.90536308288574, "new_tokens_created": true, "old_token_revoked": true, "session_id": "f030d611-2fbd-4d4a-934b-79b8467bccb0"}, "timestamp": "2025-08-30T18:16:54.757173Z", "environment": "development", "request_id": "c330b92c-1c2e-4c61-9704-fbda88abdf7d", "service": "blood-bank-api", "event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 433.90536308288574, "new_tokens_created": true, "old_token_revoked": true, "session_id": "f030d611-2fbd-4d4a-934b-79b8467bccb0"}
{"asctime": "2025-08-30 18:19:14,144", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: request_response_error", "extra_fields": {"event_type": "request_response_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequest' object has no attribute 'quantity'", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "duration_ms": 51.54156684875488}, "timestamp": "2025-08-30T18:19:14.144334Z", "environment": "development", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "request_response_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "'BloodRequest' object has no attribute 'quantity'", "duration_ms": 51.54156684875488}
{"asctime": "2025-08-30 18:21:26,493", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_request_response", "extra_fields": {"event_type": "blood_request_response", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "old_status": "accepted", "new_status": "accepted", "blood_type": "B+", "quantity": 21, "duration_ms": 61.820268630981445}, "timestamp": "2025-08-30T18:21:26.493788Z", "environment": "development", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_request_response", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "old_status": "accepted", "new_status": "accepted", "blood_type": "B+", "quantity": 21, "duration_ms": 61.820268630981445}
{"asctime": "2025-08-30 21:29:09,403", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: token_refresh_success", "extra_fields": {"event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 854.1216850280762, "new_tokens_created": true, "old_token_revoked": true, "session_id": "2869d7d5-ff25-4d39-9194-2fde1d54d9ca"}, "timestamp": "2025-08-30T21:29:09.403449Z", "environment": "development", "request_id": "4d0b344d-1f4d-408b-8fff-06a7606daeb2", "service": "blood-bank-api", "event_type": "token_refresh_success", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "duration_ms": 854.1216850280762, "new_tokens_created": true, "old_token_revoked": true, "session_id": "2869d7d5-ff25-4d39-9194-2fde1d54d9ca"}
{"asctime": "2025-08-30 21:30:29,983", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: blood_request_response", "extra_fields": {"event_type": "blood_request_response", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "old_status": "accepted", "new_status": "accepted", "blood_type": "B+", "quantity": 21, "duration_ms": 52.272796630859375}, "timestamp": "2025-08-30T21:30:29.983106Z", "environment": "development", "request_id": "c3a48981-18be-4bae-b101-1b7f67b61365", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "blood_request_response", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "old_status": "accepted", "new_status": "accepted", "blood_type": "B+", "quantity": 21, "duration_ms": 52.272796630859375}
{"asctime": "2025-08-30 22:03:27,410", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_creation_error", "extra_fields": {"event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "(sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('52baaa58ff9946798d845d3184953305', <TrackStateStatus.pending_receive: 'pending receive'>, 'Korle-Bu Blood Bank', 'Distribution created, awaiting dispatch', '2025-08-30 22:03:26.474928', '96a95bae70104a10bfb83a829608f172', None, '88e3fafa3fdc408ea261f5dfdd43b2bb')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "duration_ms": 111.04083061218262}, "timestamp": "2025-08-30T22:03:27.411035Z", "environment": "development", "request_id": "90716715-3d48-4d4e-83cb-72909d4db926", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "(sqlite3.IntegrityError) NOT NULL constraint failed: track_states.blood_request_id\n[SQL: INSERT INTO track_states (id, status, location, notes, timestamp, blood_distribution_id, blood_request_id, created_by_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('52baaa58ff9946798d845d3184953305', <TrackStateStatus.pending_receive: 'pending receive'>, 'Korle-Bu Blood Bank', 'Distribution created, awaiting dispatch', '2025-08-30 22:03:26.474928', '96a95bae70104a10bfb83a829608f172', None, '88e3fafa3fdc408ea261f5dfdd43b2bb')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "duration_ms": 111.04083061218262}
{"asctime": "2025-08-30 22:11:24,202", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_created", "extra_fields": {"event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "834c1b5c-07dd-4b2f-97d2-f154fc26ef16", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 140.73586463928223}, "timestamp": "2025-08-30T22:11:24.202170Z", "environment": "development", "request_id": "4a389a5c-6663-4a6c-98c6-6d6541c8e556", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "834c1b5c-07dd-4b2f-97d2-f154fc26ef16", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 140.73586463928223}
{"asctime": "2025-08-30 22:11:24,486", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_creation_error", "extra_fields": {"event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 173.2165813446045}, "timestamp": "2025-08-30T22:11:24.486481Z", "environment": "development", "request_id": "4a389a5c-6663-4a6c-98c6-6d6541c8e556", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 173.2165813446045}
{"asctime": "2025-08-30 22:15:10,094", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_created", "extra_fields": {"event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "16f88dc0-761a-4a53-80cd-d39631d567e3", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 119.29726600646973}, "timestamp": "2025-08-30T22:15:10.094719Z", "environment": "development", "request_id": "12298cd5-f0fd-4f4f-a347-36d3fcd717f5", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "16f88dc0-761a-4a53-80cd-d39631d567e3", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 119.29726600646973}
{"asctime": "2025-08-30 22:15:10,111", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_creation_error", "extra_fields": {"event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 123.50106239318848}, "timestamp": "2025-08-30T22:15:10.111771Z", "environment": "development", "request_id": "12298cd5-f0fd-4f4f-a347-36d3fcd717f5", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 123.50106239318848}
{"asctime": "2025-08-30 22:21:14,316", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_created", "extra_fields": {"event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "3389f502-523c-4925-8654-49970cfbed28", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 118.39890480041504}, "timestamp": "2025-08-30T22:21:14.316657Z", "environment": "development", "request_id": "79a6f8fd-eeef-4da9-b65e-746a844cae38", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "3389f502-523c-4925-8654-49970cfbed28", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 118.39890480041504}
{"asctime": "2025-08-30 22:30:15,912", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_created", "extra_fields": {"event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "728af2b7-07c8-4cf7-bd08-8c9b8dfc40ee", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 130.5861473083496}, "timestamp": "2025-08-30T22:30:15.912985Z", "environment": "development", "request_id": "a7441dde-2128-4949-9b78-494074df36d6", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "distribution_id": "728af2b7-07c8-4cf7-bd08-8c9b8dfc40ee", "blood_product": "Whole Blood", "blood_type": "B+", "quantity": 1, "dispatched_from_id": "7588cda5-37a5-4700-b40f-570cecbb5f37", "dispatched_to_id": "26c54e83-72db-4197-9117-779d8f848870", "duration_ms": 130.5861473083496}
{"asctime": "2025-08-30 22:30:15,928", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_creation_error", "extra_fields": {"event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending receive', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 135.41460037231445}, "timestamp": "2025-08-30T22:30:15.928957Z", "environment": "development", "request_id": "a7441dde-2128-4949-9b78-494074df36d6", "user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "service": "blood-bank-api", "event_type": "distribution_creation_error", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "88e3fafa-3fdc-408e-a261-f5dfdd43b2bb", "reason": "unexpected_error", "error": "1 validation error for BloodDistributionResponse\nstatus\n  Input should be 'pending receive', 'in transit', 'delivered', 'cancelled' or 'returned' [type=enum, input_value=<BloodDistributionStatus....eive: 'pending recieve'>, input_type=BloodDistributionStatus]\n    For further information visit https://errors.pydantic.dev/2.11/v/enum", "duration_ms": 135.41460037231445}
{"asctime": "2025-08-30 22:50:06,782", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: successful_login", "extra_fields": {"event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "last_login": "2025-08-30T22:50:06.679280+00:00", "failed_attempts_reset": true}, "timestamp": "2025-08-30T22:50:06.782775Z", "environment": "development", "request_id": "9e8c303d-f4bc-42e6-b37e-73cb53dbe3be", "service": "blood-bank-api", "event_type": "successful_login", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "last_login": "2025-08-30T22:50:06.679280+00:00", "failed_attempts_reset": true}
{"asctime": "2025-08-30 22:55:13,862", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_created", "extra_fields": {"event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "9c90c82b-7a76-45a1-9555-542c06580135", "blood_product": "B+", "blood_type": "Whole Blood", "quantity": 1, "dispatched_from_id": "a18e57a0-d7fc-44e5-b0c9-09227fc283e6", "dispatched_to_id": "81de6589-c407-436c-8be2-248dbbcd6dc0", "duration_ms": 164.0634536743164}, "timestamp": "2025-08-30T22:55:13.862780Z", "environment": "development", "request_id": "9127fc5b-4d62-4773-8457-c0be858c2e15", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "service": "blood-bank-api", "event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "9c90c82b-7a76-45a1-9555-542c06580135", "blood_product": "B+", "blood_type": "Whole Blood", "quantity": 1, "dispatched_from_id": "a18e57a0-d7fc-44e5-b0c9-09227fc283e6", "dispatched_to_id": "81de6589-c407-436c-8be2-248dbbcd6dc0", "duration_ms": 164.0634536743164}
{"asctime": "2025-08-30 23:04:18,159", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_created", "extra_fields": {"event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "f253e745-cf33-487e-997a-1c29ab8fc35e", "blood_product": "B+", "blood_type": "Whole Blood", "quantity": 1, "dispatched_from_id": "a18e57a0-d7fc-44e5-b0c9-09227fc283e6", "dispatched_to_id": "81de6589-c407-436c-8be2-248dbbcd6dc0", "duration_ms": 150.79045295715332}, "timestamp": "2025-08-30T23:04:18.159251Z", "environment": "development", "request_id": "80e4ed1e-7d8d-4517-abd4-8598a66de53c", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "service": "blood-bank-api", "event_type": "distribution_created", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "f253e745-cf33-487e-997a-1c29ab8fc35e", "blood_product": "B+", "blood_type": "Whole Blood", "quantity": 1, "dispatched_from_id": "a18e57a0-d7fc-44e5-b0c9-09227fc283e6", "dispatched_to_id": "81de6589-c407-436c-8be2-248dbbcd6dc0", "duration_ms": 150.79045295715332}
{"asctime": "2025-08-30 23:29:24,896", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: distribution_status_changed", "extra_fields": {"event_type": "distribution_status_changed", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "9c90c82b-7a76-45a1-9555-542c06580135", "old_status": "pending receive", "new_status": "delivered", "duration_ms": 182.1157932281494}, "timestamp": "2025-08-30T23:29:24.896181Z", "environment": "development", "request_id": "0bb853ef-5996-4b5e-8712-72c56e6b0dc8", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "service": "blood-bank-api", "event_type": "distribution_status_changed", "ip_address": "127.0.0.1", "user_agent": null, "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "distribution_id": "9c90c82b-7a76-45a1-9555-542c06580135", "old_status": "pending receive", "new_status": "delivered", "duration_ms": 182.1157932281494}
{"asctime": "2025-08-30 23:31:47,753", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: unauthorized_access_attempt", "extra_fields": {"event_type": "unauthorized_access_attempt", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "required_permissions": ["blood.distribution.can_view", "blood.inventory.can_view", "blood.tracking.can_view"], "user_permissions": ["facility.manage", "account.can_view_profile"], "user_email": "admin1@example.com"}, "timestamp": "2025-08-30T23:31:47.753708Z", "environment": "development", "request_id": "48322b5b-2c57-42a1-9a5e-53ba447e0fbc", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "service": "blood-bank-api", "event_type": "unauthorized_access_attempt", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "required_permissions": ["blood.distribution.can_view", "blood.inventory.can_view", "blood.tracking.can_view"], "user_permissions": ["facility.manage", "account.can_view_profile"], "user_email": "admin1@example.com"}
{"asctime": "2025-08-30 23:35:01,078", "levelname": "INFO", "name": "security", "funcName": "log_security_event", "lineno": 351, "message": "Security event: unauthorized_access_attempt", "extra_fields": {"event_type": "unauthorized_access_attempt", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "required_permissions": ["blood.distribution.can_view", "blood.inventory.can_view", "blood.tracking.can_view"], "user_permissions": ["facility.manage", "account.can_view_profile"], "user_email": "admin1@example.com"}, "timestamp": "2025-08-30T23:35:01.078810Z", "environment": "development", "request_id": "41da3d5a-24fc-45fe-a8dc-65c22506c240", "user_id": "b46ec232-7138-4895-a335-0e742110479a", "service": "blood-bank-api", "event_type": "unauthorized_access_attempt", "ip_address": "127.0.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36", "severity": "medium", "target_user_id": "b46ec232-7138-4895-a335-0e742110479a", "required_permissions": ["blood.distribution.can_view", "blood.inventory.can_view", "blood.tracking.can_view"], "user_permissions": ["facility.manage", "account.can_view_profile"], "user_email": "admin1@example.com"}
